<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.8 Integration techniques | Math review for new biostatistics students</title>
  <meta name="description" content="2.8 Integration techniques | Math review for new biostatistics students" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2.8 Integration techniques | Math review for new biostatistics students" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.8 Integration techniques | Math review for new biostatistics students" />
  
  
  

<meta name="author" content="Patrick Breheny and Eldon Sorensen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="improper-integrals.html"/>
<link rel="next" href="sequences-and-series.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="calculus.html"><a href="calculus.html"><i class="fa fa-check"></i><b>2</b> Calculus</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>2.1</b> Functions</a></li>
<li class="chapter" data-level="2.2" data-path="limits-and-continuity.html"><a href="limits-and-continuity.html"><i class="fa fa-check"></i><b>2.2</b> Limits and continuity</a></li>
<li class="chapter" data-level="2.3" data-path="derivatives.html"><a href="derivatives.html"><i class="fa fa-check"></i><b>2.3</b> Derivatives</a></li>
<li class="chapter" data-level="2.4" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>2.4</b> Optimization</a></li>
<li class="chapter" data-level="2.5" data-path="integration.html"><a href="integration.html"><i class="fa fa-check"></i><b>2.5</b> Integration</a></li>
<li class="chapter" data-level="2.6" data-path="logarithm-and-exponential.html"><a href="logarithm-and-exponential.html"><i class="fa fa-check"></i><b>2.6</b> Logarithm and exponential</a></li>
<li class="chapter" data-level="2.7" data-path="improper-integrals.html"><a href="improper-integrals.html"><i class="fa fa-check"></i><b>2.7</b> Improper integrals</a></li>
<li class="chapter" data-level="2.8" data-path="integration-techniques.html"><a href="integration-techniques.html"><i class="fa fa-check"></i><b>2.8</b> Integration techniques</a></li>
<li class="chapter" data-level="2.9" data-path="sequences-and-series.html"><a href="sequences-and-series.html"><i class="fa fa-check"></i><b>2.9</b> Sequences and series</a></li>
<li class="chapter" data-level="2.10" data-path="partial-derivatives.html"><a href="partial-derivatives.html"><i class="fa fa-check"></i><b>2.10</b> Partial derivatives</a></li>
<li class="chapter" data-level="2.11" data-path="multiple-integrals.html"><a href="multiple-integrals.html"><i class="fa fa-check"></i><b>2.11</b> Multiple integrals</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>3</b> Matrix algebra</a>
<ul>
<li class="chapter" data-level="3.1" data-path="definitions-and-conventions.html"><a href="definitions-and-conventions.html"><i class="fa fa-check"></i><b>3.1</b> Definitions and conventions</a></li>
<li class="chapter" data-level="3.2" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>3.2</b> Basic operations</a></li>
<li class="chapter" data-level="3.3" data-path="special-matrices.html"><a href="special-matrices.html"><i class="fa fa-check"></i><b>3.3</b> Special matrices</a></li>
<li class="chapter" data-level="3.4" data-path="inversion-and-related-concepts.html"><a href="inversion-and-related-concepts.html"><i class="fa fa-check"></i><b>3.4</b> Inversion and related concepts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>4</b> Analysis</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Math review for new biostatistics students</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="integration-techniques" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Integration techniques<a href="integration-techniques.html#integration-techniques" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="integration.html#fundamental-theorem-of-calculus">Every time we compute a derivative, we get a formula for integration</a>. For example,</p>
<p><span class="math display">\[ f(x) = \log(x^2 + 2) \implies f&#39;(x) = \frac{2x}{x^2 + 2}. \]</span></p>
<p>This is great news if we are ever faced with the problem of calculating</p>
<p><span class="math display">\[ \int_a^b \frac{2x}{x^2 + 2} \,dx, \]</span></p>
<p>but if we need to calculate <span class="math inline">\(\int_a^b f(x) \,dx\)</span>, how can we reverse engineer a function <span class="math inline">\(F(x)\)</span> so that its derivative is <span class="math inline">\(f(x)\)</span>?</p>
<p>Unfortunately, this task is sometimes easy, sometimes hard, and sometimes impossible (and you have no way of knowing in advance which situation you are in). One could create a huge table of integral formulas by taking derivatives of various things. Providing such a table is beyond the scope of this review, but <a href="https://www.integral-table.com/">such tables exist online</a> and are useful resources to be aware of.</p>
<p>Even with such a table, however, there are a few useful integration techniques to be familiar with. Among other things, (a) it may be faster to use one of these techniques than looking up an integral (b) you might not have access to such a table at the moment, and (c) the form that appears in the table might be slightly different than what you need, and you might have to use one of these techniques in combination with the table to compute the integral.</p>
<div id="substitution" class="section level3 unnumbered hasAnchor">
<h3>Substitution<a href="integration-techniques.html#substitution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By far the most important technique to be aware of is substitution. For example, <a href="logarithm-and-exponential.html#exponential-derivatives-and-integrals">we know that</a> <span class="math inline">\(\int e^x \,dx= e^x\)</span>, but what if we have to find <span class="math inline">\(\int e^{2x} \,dx\)</span>? Is it <span class="math inline">\(e^{2x}\)</span>? The answer (and this is extremely important to understand, because it comes up in statistics all the time) is that no, it isn’t. We can check this easily using the <a href="derivatives.html#formulas">chain rule</a>: the derivative of <span class="math inline">\(e^{2x}\)</span> is <span class="math inline">\(2e^{2x}\)</span>, so <span class="math inline">\(\int e^{2x} \,dx\ne e^{2x}\)</span>.</p>
<p>In this case, it’s also fairly clear what we need to do in order to fix the problem: <span class="math inline">\(\int e^{2x} \,dx\)</span> must be <span class="math inline">\(\tfrac{1}{2}e^{2x}\)</span>: there must be a 1/2 present to cancel the 2 that comes from the chain rule.</p>
<p>Conceptually, letting <span class="math inline">\(u=2x\)</span>, we can visualize what’s going on here as follows. Each unit of <span class="math inline">\(u\)</span> covers twice as much ground as a unit of <span class="math inline">\(x\)</span>. If we don’t do something to correct for this, we’re going to artificially inflate the area under the curve integral (i.e., the integral). This is what’s going on in the red region below, which clearly has greater area than the blue region (the integral we’re trying to calculate).</p>
<p><img src="math-review_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>However, if we compensate for this – we’re stretching <span class="math inline">\(x\)</span> out by a factor of 2, so we need to shrink the value of the function by a factor of 2 to preserve the correct area – we get the green region, which has the same area as the original blue region.</p>
<p>To formalize this thinking into a procedure, if <span class="math inline">\(u=g(x)\)</span>, then (this works for any differentiable function <span class="math inline">\(g\)</span>)</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(du = g&#39;(x) \,dx\)</span></li>
<li>Substitute <span class="math inline">\(u\)</span> for <span class="math inline">\(g(x)\)</span> and <span class="math inline">\(1/g&#39;(x) \,du\)</span> for <span class="math inline">\(dx\)</span></li>
<li>Take the integral</li>
<li>Substitute <span class="math inline">\(g(x)\)</span> back for <span class="math inline">\(u\)</span></li>
</ol>
<p>If we are calculating a definite integral, then instead of step 4, we can transform the limits of integration <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> to <span class="math inline">\(g(a)\)</span> and <span class="math inline">\(g(b)\)</span>; this is usually preferable.</p>
<p>As practice, use this procedure to calculate</p>
<p><span class="math display">\[ \int x (x^2 - 1)^5 \,dx. \]</span></p>
<p>You should get <span class="math inline">\(\tfrac{1}{12} (x^2 - 1)^6\)</span>.</p>
</div>
<div id="integration-by-parts" class="section level3 unnumbered hasAnchor">
<h3>Integration by parts<a href="integration-techniques.html#integration-by-parts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just as the chain rule gave us substitution, the <a href="derivatives.html#formulas">product rule</a> gives us a formula called integration by parts, which is usually written in the form:</p>
<p><span class="math display">\[ \int u \,dv = uv - \int v \,du. \]</span></p>
<p>As an example of integration by parts in action, suppose we want to integrate <span class="math inline">\(\int \log x \,dx\)</span>. We can write this as</p>
<p><span class="math display">\[\begin{align*}
u &amp;= \log x &amp;\qquad dv &amp;= dx \\
du &amp;= \frac{1}{x} \,dx&amp;\qquad v &amp;= x
\end{align*}\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[\begin{align*}
\int \log x \,dx&amp;= x \log x - \int x \frac{dx}{x} \\
  &amp;= x \log x - \int \,dx\\
  &amp;= x \log x - x
\end{align*}\]</span></p>
<p>As practice, use this procedure to calculate</p>
<p><span class="math display">\[ \int x e^x \,dx. \]</span></p>
<p>You should get <span class="math inline">\(x e^x - e^x\)</span>.</p>
</div>
<div id="kernel-trick" class="section level3 unnumbered hasAnchor">
<h3>Kernel trick<a href="integration-techniques.html#kernel-trick" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The above techniques are useful, but in statistics it is often the case that you can avoid them entirely and calculate the answer much faster using something I will call the “kernel trick” (I am not aware of this idea having an official name).</p>
<p>For example, suppose we need to calculate</p>
<p><span class="math display">\[ \int_0^\infty e^{-5x} \,dx. \]</span></p>
<p>Sure, we <em>can</em> use substitution, but most statisticians will find it easier to recognize that this is very similar to the exponential distribution, which (like all distributions) integrates to 1:</p>
<p><span class="math display">\[ \int_0^\infty \lambda e^{-\lambda x} \,dx= 1 \text{ for all } \lambda&gt; 0. \]</span></p>
<p>Applying this shortcut:</p>
<p><span class="math display">\[\begin{align*}
\int_0^{\infty} e^{-5x} \,dx&amp;= \frac{1}{5} \int_0^\infty 5 e^{-5x} \,dx\\
  &amp;= \frac{1}{5}
\end{align*}\]</span></p>
<p>The <em>kernel</em> of a distribution is the part that has the variable we’re integrating over. This is the only part that needs to match in order for the trick to work: we can always manipulate the constants as we did above.</p>
<p>As another example, suppose we need to find</p>
<p><span class="math display">\[ \int_{-\infty}^\infty e^{-x^2} \,dx. \]</span></p>
<p>This is actually impossible to solve using any of the integration techniques above – there is no elementary form form for its antiderivative. However, it has the kernel of a normal distribution:</p>
<p><span class="math display">\[ \frac{1}{\sigma \sqrt{2\pi}} \exp\left\{ -\frac{1}{2} \left( \frac{x - \mu}{\sigma} \right)^2 \right\} \]</span></p>
<p>Letting <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma = 1/\sqrt{2}\)</span>, we get</p>
<p><span class="math display">\[\begin{align*}
\int_{-\infty}^\infty e^{-x^2} \,dx&amp;= \sqrt{\pi} \int_{-\infty}^\infty \frac{1}{\sqrt{2\pi} / \sqrt{2}} \exp\left\{ -\frac{1}{2} \left( \frac{x}{1/\sqrt{2}} \right)^2 \right\} \\
  &amp;= \sqrt{\pi}
\end{align*}\]</span></p>
<p>This may seem complicated at first, but I cannot emphasize enough how important it is to learn this. As a statistician you will become very familiar with these distributions and this will get easier and easier. Every fall, in a ritual as constant as the turning of the leaves, first-year graduate students labor away, trying to solve integrals using elaborate integration by parts techniques, and a professor or older graduate student will look at what they are doing and solve it in seconds using this trick.</p>
<p>As practice, use this procedure to calculate</p>
<p><span class="math display">\[ \int_0^\infty x^2 e^{-x} \,dx\]</span></p>
<p>by using the kernel trick with respect to the gamma distribution, which has density function</p>
<p><span class="math display">\[ \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x}. \]</span></p>
<p>You should get <span class="math inline">\(\Gamma(3)\)</span>, which is 2: <span class="math inline">\(\Gamma(\alpha) = (\alpha-1)!\)</span> if <span class="math inline">\(\alpha\)</span> is an integer.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="improper-integrals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sequences-and-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["math-review.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
