<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.11 Multiple integrals | Math review for new biostatistics students</title>
  <meta name="description" content="2.11 Multiple integrals | Math review for new biostatistics students" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2.11 Multiple integrals | Math review for new biostatistics students" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.11 Multiple integrals | Math review for new biostatistics students" />
  
  
  

<meta name="author" content="Patrick Breheny and Eldon Sorensen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="partial-derivatives.html"/>
<link rel="next" href="matrix-algebra.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="calculus.html"><a href="calculus.html"><i class="fa fa-check"></i><b>2</b> Calculus</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>2.1</b> Functions</a></li>
<li class="chapter" data-level="2.2" data-path="limits-and-continuity.html"><a href="limits-and-continuity.html"><i class="fa fa-check"></i><b>2.2</b> Limits and continuity</a></li>
<li class="chapter" data-level="2.3" data-path="derivatives.html"><a href="derivatives.html"><i class="fa fa-check"></i><b>2.3</b> Derivatives</a></li>
<li class="chapter" data-level="2.4" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>2.4</b> Optimization</a></li>
<li class="chapter" data-level="2.5" data-path="integration.html"><a href="integration.html"><i class="fa fa-check"></i><b>2.5</b> Integration</a></li>
<li class="chapter" data-level="2.6" data-path="logarithm-and-exponential.html"><a href="logarithm-and-exponential.html"><i class="fa fa-check"></i><b>2.6</b> Logarithm and exponential</a></li>
<li class="chapter" data-level="2.7" data-path="improper-integrals.html"><a href="improper-integrals.html"><i class="fa fa-check"></i><b>2.7</b> Improper integrals</a></li>
<li class="chapter" data-level="2.8" data-path="integration-techniques.html"><a href="integration-techniques.html"><i class="fa fa-check"></i><b>2.8</b> Integration techniques</a></li>
<li class="chapter" data-level="2.9" data-path="sequences-and-series.html"><a href="sequences-and-series.html"><i class="fa fa-check"></i><b>2.9</b> Sequences and series</a></li>
<li class="chapter" data-level="2.10" data-path="partial-derivatives.html"><a href="partial-derivatives.html"><i class="fa fa-check"></i><b>2.10</b> Partial derivatives</a></li>
<li class="chapter" data-level="2.11" data-path="multiple-integrals.html"><a href="multiple-integrals.html"><i class="fa fa-check"></i><b>2.11</b> Multiple integrals</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>3</b> Matrix algebra</a>
<ul>
<li class="chapter" data-level="3.1" data-path="definitions-and-conventions.html"><a href="definitions-and-conventions.html"><i class="fa fa-check"></i><b>3.1</b> Definitions and conventions</a></li>
<li class="chapter" data-level="3.2" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>3.2</b> Basic operations</a></li>
<li class="chapter" data-level="3.3" data-path="special-matrices.html"><a href="special-matrices.html"><i class="fa fa-check"></i><b>3.3</b> Special matrices</a></li>
<li class="chapter" data-level="3.4" data-path="inversion-and-related-concepts.html"><a href="inversion-and-related-concepts.html"><i class="fa fa-check"></i><b>3.4</b> Inversion and related concepts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>4</b> Analysis</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Math review for new biostatistics students</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-integrals" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Multiple integrals<a href="multiple-integrals.html#multiple-integrals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In statistics, we also (quite often!) need to integrate functions involving multiple variables. Considering trying to integrate the following function:</p>
<p><span class="math display">\[ f(x,y) = x^2y. \]</span></p>
<p>Similar to <a href="partial-derivatives.html#partial-derivatives">partial derivatives</a>, we could integrate with respect to <span class="math inline">\(x\)</span> (treating <span class="math inline">\(y\)</span> as a constant) or integrate with respect to <span class="math inline">\(y\)</span> (treating <span class="math inline">\(x\)</span> as constant). This should be relatively straightforward for you to get <span class="math inline">\(x^3y/3\)</span> and <span class="math inline">\(x^2y^2/2\)</span> in these two scenarios.</p>
<p>However, we often need to integrate with respect to <em>both</em> <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Thankfully, this can be done one variable at a time:</p>
<p><span class="math display">\[\begin{align*}
\int\int f(x,y) \,dx\,dy&amp;= \int \left\{ \int f(x,y) \,dx\right\} \,dy\\
  &amp;= \int \left\{ \int f(x,y) \,dy\right\} \,dx.
\end{align*}\]</span></p>
<p>As we saw with <a href="partial-derivatives.html#higher-orders">second-order partial derivatives</a>, it turns out that if <span class="math inline">\(f\)</span> is <a href="limits-and-continuity.html#continuity">continuous</a>, the order of integration doesn’t matter (this is known as Fubini’s theorem); more on this later.</p>
<p>Let’s say we’ve decided to integrate with respect to <span class="math inline">\(x\)</span> first, then <span class="math inline">\(y\)</span> (as we indicate when we write <span class="math inline">\(\,dx\,dy\)</span>):</p>
<p><span class="math display">\[\begin{align*}
\int \int x^2 y \,dx\,dy&amp;= \int \left\{ \frac{x^3y}{3} \right\} \,dy\\
  &amp;= \frac{x^3y^2}{6}
\end{align*}\]</span></p>
<p>Suppose now that we want to integrate <span class="math inline">\(f(x,y) = x^2y\)</span> across the rectangular region <span class="math inline">\(0 \le x \le 1\)</span> and <span class="math inline">\(0 \le y \le 1\)</span> (i.e., to take the definite integral). This would go as follows:</p>
<p><span class="math display">\[\begin{align*}
\int_0^1 \int_0^1 x^2 y \,dx\,dy&amp;= \int_0^1 \left\{ \frac{x^3y}{3} \Bigr\rvert_{x=0}^1\right\} \,dy\\
  &amp;= \int_0^1 \left\{ \frac{(1)^3y}{3} - \frac{(0)^3y}{3} \right\} \,dy\\
  &amp;= \int_0^1 \frac{y}{3} \,dy\\
  &amp;= \frac{1^2}{6} - \frac{0^2}{6} \\
  &amp;= \frac{1}{6}
\end{align*}\]</span></p>
<p>Conceptually, <span class="math inline">\(\frac{1}{6}\)</span> represents the volume encompassed within the function <span class="math inline">\(x^2y\)</span> across the rectangular region <span class="math inline">\(0 \leq x \leq 1\)</span> and <span class="math inline">\(0 \leq y \leq 1\)</span>; this volume and the rectangular <span class="math inline">\(x,y\)</span> region are depicted below:</p>
<p><img src="math-review_files/figure-html/unnamed-chunk-4-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Multiple integrals can taken over any number of input variables:</p>
<p><span class="math display">\[ \int \cdots \int f(x_1, \ldots, x_n) \,dx_1 \ldots \,dx_n \]</span></p>
<p>As practice, integrate <span class="math inline">\(f(x,y,z) = x^3z/y\)</span> across x, then y and then z (a triple integral). You should get <span class="math inline">\(x^4 z^2 \log(y)/8\)</span>.</p>
<!-- $\int\int\int f(x,y,z) dx dy dz = \int\int(\int \frac{x^3z}{y} dx) dy dz = \int(\int \frac{x^4z}{4y} dy) dz = \int \frac{x^4zln(y)}{4} dz = \frac{x^4z^2ln(y)}{8}$ -->
<div id="non-rectangular-regions" class="section level3 unnumbered hasAnchor">
<h3>Non-rectangular regions<a href="multiple-integrals.html#non-rectangular-regions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A final complication to be aware of with multiple integrals is that the region over which we are integrating may not be rectangular. For example, let’s consider our same function as before, <span class="math inline">\(f(x,y) = x^2 y\)</span>, but now our region of integration will be <span class="math inline">\(0 \leq x \leq y \leq 1\)</span>:</p>
<p><img src="math-review_files/figure-html/unnamed-chunk-5-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Note that all the points in the green triangle (and only the points in the green triangle) satisfy <span class="math inline">\(0 \leq x \leq y \leq 1\)</span>. At <span class="math inline">\(x = 0.4\)</span> for instance, only points where <span class="math inline">\(y\)</span> is greater than or equal to 0.4 and less than 1 are shaded green. In comparison with the earlier rectangular region, note that the lower right half is no longer included.</p>
<p>The procedure to integrate <span class="math inline">\(\int \int f(x, y) \,dx\,dy\)</span> is the same as before, but we need to pay closer attention to the bounds. Since we’re starting with respect to <span class="math inline">\(x\)</span>, let’s figure out the appropriate <span class="math inline">\(x\)</span> bounds. Visualizing the green region plotted above is immensely helpful in determining the upper and lower bounds for <span class="math inline">\(x\)</span> (you don’t necessarily need to use a computer, but you should always draw the region of integration if it is not rectangular). To determine the lower and upper bounds of the inner integral with respect to <span class="math inline">\(x\)</span>, we need to answer the question: at any given value of <span class="math inline">\(y\)</span>, what values of <span class="math inline">\(x\)</span> are within the green region? The answer is: <span class="math inline">\(0 \le x \le y\)</span>. For instance, at <span class="math inline">\(y = 0.2\)</span>, <span class="math inline">\(x\)</span> can range from 0 to 0.2.</p>
<p>Regarding the range of <span class="math inline">\(y\)</span> (the outer integral), we need to include the entire range of 0 to 1 in order to capture the entire triangular region. To visualize this, imagine drawing a line over the valid <span class="math inline">\(x\)</span> values, and repeating this process for every <span class="math inline">\(y\)</span> value in the range of 0 to 1. A depiction of what this would look like is provided below (hopefully it is clear that the collection of lines would yield the triangle):</p>
<p><img src="math-review_files/figure-html/unnamed-chunk-6-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Evaluating the integral, we therefore have:</p>
<p><span class="math display">\[\begin{align*}
\int_0^1 \int_0^y x^2 y \,dx\,dy&amp;= \int_0^1 \left\{ \frac{x^3y}{3} \Bigr\rvert_{x=0}^y \right\} \,dy\\
  &amp;= \int_0^1 \left\{ \frac{(y)^3y}{3} - \frac{(0)^3y}{3} \right\} \,dy\\
  &amp;= \int_0^1 \frac{y^4}{3} \,dy\\
  &amp;= \frac{1^5}{15} - \frac{0^5}{15} \\
  &amp;= \frac{1}{15}
\end{align*}\]</span></p>
<p>Intuitively, this makes sense – our region is smaller, so the volume should be smaller (1/15 instead of 1/6).</p>
<p>As we mentioned earlier, the order of integration doesn’t matter. As practice, integrate <span class="math inline">\(x^2 y\)</span> over the region <span class="math inline">\(0 \leq x \leq y \leq 1\)</span>, but this time start by integrating over <span class="math inline">\(y\)</span>. Obviously, you should still get 1/15. Hint: to help visualize things, you should draw a figure that looks like this:</p>
<p><img src="math-review_files/figure-html/unnamed-chunk-7-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>If you want even more practice, trying integrating <span class="math inline">\(x^2 y\)</span> over the region <span class="math inline">\(0 \le y \le x \leq 1\)</span>. You should get 1/10 (i.e., <span class="math inline">\(1/6 - 1/15\)</span>).</p>
<p>Note that while either order gives the same answer, they do not necessarily involve the same amount of work. It is often the case that one route is much easier to calculate than the other, so keep this in mind if one of the integrals becomes difficult to calculate. And remember to draw those regions of integration (really can’t stress that enough)!</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="partial-derivatives.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="matrix-algebra.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["math-review.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
